type: dev-environment
# The name is optional, if not specified, generated randomly aa
name: cursor

python: "3.12"
ide: cursor

env:
  - HF_TOKEN
  - HUGGINGFACE_TOKEN
  - WANDB_API_KEY

init:
  - apt-get update && apt-get install -y wget gnupg
  - wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-keyring_1.1-1_all.deb
  - dpkg -i cuda-keyring_1.1-1_all.deb
  - rm -f /etc/apt/sources.list.d/cuda*.list
  - wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin
  - mv cuda-ubuntu2004.pin /etc/apt/preferences.d/cuda-repository-pin-600
  - wget https://developer.download.nvidia.com/compute/cuda/12.4.0/local_installers/cuda-repo-ubuntu2004-12-4-local_12.4.0-550.54.14-1_amd64.deb
  - dpkg -i cuda-repo-ubuntu2004-12-4-local_12.4.0-550.54.14-1_amd64.deb
  - cp /var/cuda-repo-ubuntu2004-12-4-local/cuda-*-keyring.gpg /usr/share/keyrings/
  - apt-get update
  - apt-get install -y cuda-toolkit-12-4
  - echo 'export PATH=/usr/local/cuda-12.4/bin:$PATH' >> ~/.bashrc
  - echo 'export LD_LIBRARY_PATH=/usr/local/cuda-12.4/lib64:$LD_LIBRARY_PATH' >> ~/.bashrc
  - source ~/.bashrc
  - nvcc --version

resources:
  gpu: A100
  disk: 500GB
  shm_size: 2GB

backends:
  - vastai
  - runpod
  - lambda
  - datacrunch

